;; main contains multiple manipulators
;; each manipulator has a description and multiple rules

;; main                -> {:main [{:des "..." :rules [rule1 rule2 ...]}]}
;; manipulator         -> {:des "..." :rules [rule1 rule2 ...]}
;; manipulator's rules -> [rule1 rule2 ...]
;; define application identifiers
{
 ;; https://github.com/yqrashawn/GokuRakuJoudo/blob/master/examples.org#profiles
 :profiles
 {:goku {:default true ;
         :alone   200 ; hold for .. ms to register single tap
         :held    50 ;
         :delay   0 ; basically it means time after which the key press is count delayed
         :sim     30}
  }
 :modifiers {
             ; :super-hyper [:command :shift :control :option :fn]
             :hyper [:command :shift :control :option]
             ; :cos [:command :shift :option]
             ; :cst [:command :shift :control]
             :co [:command :option]
             ; :cs [:command :shift]
             :ct [:command :control]
             :to [:control :option]
             ; :ts [:control :shift]
             ; :os [:option :shift]
             ;
             }
 :applications {;
                :browser ["com.brave.Browser", "com.google.Chrome"]
                :arc ["company.thebrowser.Browser"]
                :slack ["com.tinyspeck.slackmacgap"]
                :termemul ["org.alacritty"]
                :spotify ["com.spotify.client"]
                :code ["com.microsoft.VSCode"]
                :jetbrains ["com.jetbrains.*"]
                :intellij ["com.jetbrains.intellij"]
                :pdfviewer ["com.apple.Preview"]
                :fakeapp ["fake.app"]
                :dbeaver ["org.jkiss.dbeaver.core.product"]
                :zoom ["us.zoom.xos"]
                :neovide ["/opt/homebrew/bin/neovide"]
                ;
                }
 :devices {
           :apple [
                   {:vendor_id 1452}
                   {:vendor_id 2652}
                   ]
           :duckyo3m [
                   {:vendor_id 12851}
                   ]
           }
 :templates {:open "open \"%s\""
             :open-a "open -a \"%s\""
             :type "osascript -e 'tell application \"System Events\" to keystroke \"%s\"'"
             :launch "osascript -e 'tell application \"%s\" to launch'"
             :paste "osascript -e 'set the clipboard to \"%s\"
             tell application \"System Events\"
             keystroke \"v\" using command down
             end tell'"
             :alfred "osascript -e 'tell application \"Alfred 5\"
             run trigger \"%s\" in workflow \"%s\" with argument \"%s\"
             end tell'"
             :km "osascript -e 'tell application \"Keyboard Maestro Engine\"
             do script \"%s\"
             end tell'"
             :application "osascript -e 'tell application \"%s\"
             try
             %s
             end try
             end tell'"
             :type-secret "osascript -e '
             set out to do shell script \"security find-generic-password -a $USER -s %s -w\"

             tell application \"System Events\" to keystroke out
             '"
             }
 :tos {;
       :emoji_picker {:key :spacebar :modi :ct} ;!CTspacebar
       :open_dev_tools {:key :i :modi :co}
       ;
       }
 :layers {
          ;          :opt_mode{
                               ;                    :key :left_command :alone {:key :left_option}
                               ;                    }
          ;          ; :caps_mode{
                                  ;          ;           :key :caps_lock :alone {:key :escape}
                                  ;          ;           }
          }
 :simlayers {;; make w key a simlayer key
             ;; layers works too, but only recommended for none typing keys
             ;; like . , tab
             ;; or keys like z, which used less often
             :0-mode {:key :0}
             :1-mode {:key :1}
             :a-mode {:key :a}
             :equal-mode {:key :equal_sign}
             :f-mode {:key :f}
             :g-mode {:key :g}
             :l-mode {:key :l}
             :q-mode {:key :q}
             :t-mode {:key :t}
             :b-mode {:key :b}
             :hyphen-mode {:key :hyphen}
             :m-mode {:key :m}
             :n-mode {:key :n}
             :comma-mode {:key :comma}
             :quote-mode {:key :quote}
             :r-mode {:key :r}
             :s-mode {:key :s}
             :v-mode {:key :v}
             :p-mode {:key :p}
             :semicolon-mode {:key :semicolon}
             :three-mode {:key :3}
             :four-mode {:key :4}
             :five-mode {:key :5}
             :tilde-mode {:key :grave_accent_and_tilde}
             :2-mode {:key :2}
             :7-mode {:key :7}
             :8-mode {:key :8}
             :9-mode {:key :9}
             :w-mode {:key :w}
             :caps-lock-mode {:key :caps_lock}
             :tab-mode {:key :tab}
             :open-bracket-mode {:key :open_bracket}
             :close-bracket-mode {:key :close_bracket}
             :x-mode {:key :x}
             :z-mode {:key :z}
             :d-mode {:key :d}
             :e-mode {:key :e}
             :slash-mode {:key :slash}
             :spacebar-mode {:key :spacebar}
             :c-mode {:key :c}
             :u-mode {:key :u}
             :left-shift-mode {:key :left_shift}
             :right-shift-mode {:key :right_shift}
             :left-option-mode-non-apple {:key :left_command}
             :right-option-mode-non-apple {:key :right_option}
             :right-command-mode-apple {:key :right_command}
             :left-option-mode-apple {:key :left_option}
             :left-command-mode-non-apple {:key :left_option}
             ; :ro-intellij-mode {:key :period :condi ["ro-intellij" 1]}
             ; :ro-lc-preview {:key :period :condi ["ro-preview" 1]}
             }
 :main [

        {:des   "spotify volume and work stuff"
         :rules [:0-mode
                 [:hyphen [:application "spotify" "set sound volume to sound volume - 5"]]
                 [:equal_sign [:application "spotify" "set sound volume to sound volume + 5"]]
                 [:9 [:alfred "shuffle" "dhth.spotify"]] ;; spotify: turn shuffle on or off
                 [:a [:alfred "tasks_work_add"  "dhth.tasks"]]
                 [:1 [:alfred "get_pass_1"  "dhth.system"]]
                 [:2 [:alfred "get_pass_2"  "dhth.system"]]
                 [:p [:open "/Applications/Spotify.app"]]
                 ]}

        {:des   "work stuff"
         :rules [:1-mode
                 ; [:2 [:km "mouse: left_click"]] ;; km: mouse: left_click
                 [:2 [:!COTSc]] ;; hammerspoon: mouse: left click
                 [:b [:alfred "todays_brain"  "dhth.brain"]] ;; alfred: dhth.brain: today's brain
                 ; [:l [:alfred "tasks_work_list"  "dhth.tasks"]]
                 ; [:l [:alfred "aws_lambda_list_functions"  "dhth.aws"]]
                 ; [:o [:alfred "add_url_to_reading"  "dhth.brain"]] ;; dhth.brain: on my mind: add entry
                 [:o "/opt/homebrew/bin/tmux switch -t wiki:o && open -a \"Alacritty\"" ] ;; tmux: switch to omm
                 [:u [:alfred "add_url_to_omm" "dhth.omm"]] ;; alfred: dhth.omm add url to omm
                 [:p [:alfred "pomodoro_work_start"  "dhth.pomodoro"]]
                 [:h :!SOCh] ;; magnet: previous display
                 [:l :!SOCl] ;; magnet: next display
                 [:k [:alfred "work_kb_file"  "dhth.workwiki.search"]] ;; alfred: work: work kb seaRch
                 ]}

        {:des   "open urls"
         :rules [:2-mode
                 [:3 [:alfred "app_switch"  "dhth.system"]] ;; alfred: system: app switch
                 [:b [:alfred "tomorrows_brain"  "dhth.brain"]] ;; alfred: dhth.brain: tomorrows's brain
                 [:n [:km "open: nikitas karabiner"]]
                 [:w [:open "http://127.0.0.1:8000"]]
                 [:e [:open "http://127.0.0.1:8001"]]
                 [:g [:open "https://github.com"]]
                 ; [:p [:open "https://github.com/pulls"]]
                 ; [:o [:alfred "open_on_my_mind"  "dhth.brain"]] ;; dhth.brain: on my mind: open list
                 [:o "/opt/homebrew/bin/tmux switch -t wiki:ow && open -a \"Alacritty\"" ] ;; tmux: switch to ommw
                 [:u [:alfred "add_url_to_ommw" "dhth.omm"]] ;; alfred: dhth.omm add url to ommw
                 [:p [:alfred "pomodoro_personal_start"  "dhth.pomodoro"]]
                 ; [:h "/opt/homebrew/bin/hs -c \"ResizeWindow('left50')\"" ] ;; hammerspoon: type out check mark
                 ; [:l "/opt/homebrew/bin/hs -c \"ResizeWindow('right50')\"" ] ;; hammerspoon: type out check mark
                 ; [:h :!TOh] ;; magnet: left
                 ; [:l :!TOl] ;; magnet: right
                 [:h "/opt/homebrew/bin/hs -c \"ResizeWindow('left50')\"" ] ;; hammerspoon: move window to left50
                 [:l "/opt/homebrew/bin/hs -c \"ResizeWindow('right50')\"" ] ;; hammerspoon: move window to right50
                 [:m "/opt/homebrew/bin/hs -c \"ResizeWindow('maximized')\"" ] ;; hammerspoon: maximise window
                 ; [:m :!TOm] ;; magnet: maximise
                 [:equal_sign :!TOf] ;; magnet: center thirds
                 ]}

        {:des   "three-mode"
         :rules [:three-mode
                 [:t [:km "open: tmux_wiki"]]
                 ; [:c [:km "open: chrome_personal"]]
                 ; [:o [:alfred "open_list_alfred"  "dhth.brain"]] ;; dhth.brain: open list in alfred
                 [:s [:km "open: setup_personal"]]
                 ; [:h [:km "mouse: move_left_small"]]
                 ; [:j [:km "mouse: move_down_small"]]
                 ; [:k [:km "mouse: move_up_small"]]
                 ; [:l [:km "mouse: move_right_small"]]
                 [:h "/opt/homebrew/bin/hs -c \"ResizeWindow('left30')\"" ] ;; hammerspoon: move window to left30
                 [:l "/opt/homebrew/bin/hs -c \"ResizeWindow('right30')\"" ] ;; hammerspoon: move window to right30
                 [:o "/opt/homebrew/bin/tmux switch -t wiki:or && open -a \"Alacritty\"" ] ;; tmux: switch to ommr
                 [:u [:alfred "add_url_to_ommr" "dhth.omm"]] ;; alfred: dhth.omm add url to ommr
                 ; [:h :!TOd] ;; magnet: one-third left
                 ; [:l :!TOg] ;; magnet: one-third right
                 ; [:m :!TOf] ;; magnet: one-third center
                 ]}

        {:des   "four mode"
         :rules [:four-mode
                 [:5 [:alfred "system_lock" "dhth.system"]]
                 [:c [:km "open: chrome_work"]]
                 ; [:j [:alfred "jira_search"  "dhth.jira"]]
                 [:j [:alfred "open_jira_ticket"  "dhth.workutils"]] ;; workutils: open jira ticket
                 [:b [:alfred "jira_sprint_board" "dhth.jira"]]
                 [:3 [:alfred "reddit_save"  "dhth.reddit"]]
                 ; [:j [:alfred "jira_manager"  "dhth.tools"]]
                 [:h :!TOe] ;; magnet: two-thirds left
                 [:l :!TOt] ;; magnet: two-thirds right
                 [:m [:open "/Applications/Spotify.app"]]
                 ]}

        {:des   "5-mode"
         :rules [:five-mode
                 [:p [:open "https://github.com/pulls"]]
                 [:k [:open "/Applications/Keyboard Maestro.app"]]
                 ; [:h :!OSh] ;; amethyst: shrink main pane
                 ; [:l :!OSl] ;; amethyst: expand main pane
                 ]}

        {:des "7-mode"
         :rules [:7-mode
                 [:6 [:alfred "quick_open_url_4" "dhth.bookmarks"]] ;; bookmarks: quick_open_url_4
                 ]
         }

        {:des "8-mode"
         :rules [:8-mode
                 [:t [:alfred "timestamp_convert" "dhth.utils"]]
                 [:a [:alfred "aws_apigateway_list_apis"  "dhth.aws"]]
                 [:9 [:alfred "logs_search"  "dhth.brain"]]
                 [:7 [:alfred "quick_open_url_3" "dhth.bookmarks"]]
                 ]
         }

        {:des   "9-mode"
         :rules [:9-mode
                 [:a [:alfred "add_url_to_work_wiki"  "dhth.bookmarks"]]
                 [:0 [:alfred "spt"  "dhth.spotify"]]
                 ; [:8 [:alfred "logs_search"  "dhth.logs"]]
                 ; [:s [:alfred "aws_s3_list_buckets"  "dhth.aws"]]
                 ]}

        {:des   "open stuff that get opened less frequently"
         :rules [:three-mode
                 [:t [:km "open: tmux_wiki"]]
                 [:c [:km "open: chrome_personal"]]
                 [:s [:km "open: setup_personal"]]
                 [:4 [:alfred "redditp"  "dhth.reddit"]]
                 ]}


        {:des   "a mode"
         :rules [:a-mode
                 ; [:s [:alfred "aws"  "dhth.aws"]]  ;; aws services search
                 ; [:b [:alfred "add_url_to_log"  "dhth.brain"]] ;; dhth.brain: add url to log
                 [:b [:!Ta :!Tb]] ;; tmux: persistent popup half screen
                 [:s [:alfred "aws" "com.ryankoval.awsconsoleservices"]]  ;; alfred: aws search
                 ; [:c [:alfred "aws_cf_user_guide"  "dhth.aws.cloudformation.userguide"]]  ;; aws cf user guide search
                 [:i [:alfred "open_chatgpt"  "dhth.bookmarks"]]  ;; alfred: bookmarks: open chatgpt
                 [:r [:!Ta :!Sr] :termemul] ;; tmux prefix + R: cmds
                 [:d [:!Ta :d] :termemul] ;; tmux prefix + d
                 [:f [:!Ta :!Tf] :termemul] ;; tmux: temporary popup
                 [:l [:!Ta :n] :termemul] ;; tmux prefix + n
                 [:h [:!Ta :p] :termemul] ;; tmux prefix + p
                 [:n [:!Ta :!Tn] :termemul] ;; tmux: pane picker across all sessions
                 [:quote [:!Ta :!Tn] :termemul] ;; tmux: window picker
                 [:n [:alfred "tmux_windows" "dhth.tmux"] :!termemul] ;; alfred: !termemul: search tmux windows
                 [:c [:!Ta :c] :termemul] ;; tmux prefix + c
                 [:z [:!Ta :z] :termemul] ;; tmux prefix + z
                 [:open_bracket [:!Ta :open_bracket] :termemul]
                 [:semicolon [:!Ta :semicolon] :termemul] ;; tmux prefix + ;
                 [:h :!SCopen_bracket :browser] ;; chrome previous tab
                 [:l :!SCclose_bracket :browser] ;; chrome next tab
                 [:h :!SCopen_bracket :arc] ;; arc: previous tab
                 [:j :!SCclose_bracket :arc] ;; arc: next tab
                 [:k :!SCopen_bracket :arc] ;; arc: previous tab
                 [:l :!SCclose_bracket :arc] ;; arc: next tab
                 [:h :!SCopen_bracket :dbeaver] ;; dbeaver: previous tab
                 [:l :!SCclose_bracket :dbeaver] ;; dbeaver: next tab
                 [:h :!SCopen_bracket :code]
                 [:l :!SCclose_bracket :code]
                 ; [:w [:alfred "add_url_to_wiki" "dhth.bookmarks"]]
                 [:w [:alfred "save_url_to_wiki" "dhth.bookmarks"]] ;; alfred: save url to a wiki
                 ; [:r [:alfred "add_url_to_reading" "dhth.brain"]] ;; alfred: dhth.brain: add url to reading
                 [:m [:alfred "add_url_to_on_my_mind" "dhth.brain"]] ;; alfred: dhth.brain: add url to "on my mind"
                 [:right_option [:open "/Applications/Slack.app"]]
                 [:b [:alfred "wiki_add_book" "dhth.wiki.search"]]
                 ; [:v [:alfred "add_word_to_records" "dhth.vocabulary"]] ;; alfred: vocab: add word to records
                 [:i [:alfred "quick_help_link" "dhth.bookmarks"]] ;; alfred: bookmarks: quick help link
                 ]}

                 {:des   "b-mode"
                  :rules [:b-mode
                          [:t [:alfred "bookmark_tag_search"  "dhth.bookmarks"]]
                          [:k [:alfred "search_books"  "dhth.files"]]
                          [:g [:alfred "blog_post"  "dhth.blog"]]
                          ; [:l [:!Ssemicolon :!S1 :b :l :a :c :k :spacebar :period] :termemul]
                          [:o [:spacebar :b :o ] :termemul ]
                          [:c [:spacebar :b :c ] :termemul ] ;; vim: Telescope: buffer commits
                          [:o [:spacebar :b :o ] :code ]
                          [:o [:spacebar :b :o ] :jetbrains ]
                          [:l [:!SOCb :!Sl] :code ] ;; vscode: foam: backlinks
                          [:l [:spacebar :b :l] :termemul ] ;; vim: wiki: backlinks
                          ; [:m :!OC5 :pdfviewer ] ;; pdfviewer: show bookmarks
                          [:m [:alfred "search"  "dhth.bookmarks"]]
                          ]}

                 {:des   "c-mode"
                  :rules [:c-mode
                          [:p [:spacebar :p :p] :termemul] ;; vim: change project
                          [:b [:spacebar :c :b] :termemul] ;; vim: check key binding: verbose nmap <leader>
                          [:p :!SOCj :browser] ;; jupyter: command palette
                          [:a [:spacebar :c :a] :termemul] ;; vim: fugitive: commit --amend
                          ; [:h :!Sopen_bracket]
                          [:l [:spacebar :c :l]] ;; vim: wiki: create link
                          [:o [:spacebar :c :o]] ;; vim: copen
                          [:j :open_bracket]
                          [:k :close_bracket]
                          [:r [:!Ssemicolon :!Sc :o :c :!Sr :e :s] :termemul] ;; vim: coc restart
                          ; [:m [:g :c :i :p] :termemul] ;; vim: commentary: inner paragraph
                          [:m [:spacebar :c :m] :termemul] ;; vim: code helpers
                          [:s [:km "alfred: search clipboard"]] ;; km: alfred: search clipboard
                          [:n [:alfred "clear_notifications" "dhth.system"]] ;; alfred: system: clear notifications
                          [:u [:alfred "get_md_url" "dhth.utils"]] ;; alfred: utils: get current url as a markdown list item
                          ]}

                 {:des   "d mode"
                  :rules [:d-mode
                          [:t :open_dev_tools :browser]
                          [:t [:spacebar :d :t] :termemul] ;; vim: windo diffthis
                          [:m :!SOd :browser] ;; dark reader
                          [:j :!Td :termemul ] ;; vim <c-d>
                          [:j :!Odown_arrow :pdfviewer ] ;; pdfviewer: page down
                          [:k :!Oup_arrow :pdfviewer ] ;; pdfviewer: page up
                          [:k :!Tu :termemul ] ;; vim <c-d>
                          [:j :!Td :jetbrains ]
                          [:k :!Tu :jetbrains ]
                          [:j :!Td :code ] ;; vim <c-d>
                          [:k :!Tu :code ] ;; vim <c-d>
                          [:o :!TOCd ] ;; toggle dato
                          [:f [:spacebar :h :e] :termemul ] ;; nvim/ftplugin/markdown.vim > wiki#Helpers()
                          [:c [:spacebar :d :c] :termemul ] ;; nvim: helpers: diff with commit
                          [:f [:!SCf :!Cn ] :code ] ;; vscode: foam: new note
                          [:f :!TOCn :jetbrains ] ;; new
                          [:s [:alfred "work_wiki_file"  "dhth.workwiki.search"]]
                          ; [:b [:alfred "db_tables_search"  "dhth.dl"]]
                          [:b [:spacebar :d :b] :termemul] ;; vim: add println
                          ;; option + arrow keys
                          [:##h :!Oleft_arrow]
                          [:##j :!Odown_arrow]
                          [:##k :!Oup_arrow]
                          [:##l :!Oright_arrow]
                          ]
                  }

                 {:des   "e mode"
                  :rules [:e-mode
                          [:r [:spacebar :e :r] :termemul ] ;; nvim/keys/mappings.vim > helpers#Helpers()
                          [:r [:!TOCp :v ] :jetbrains ] ;; jetbrains: project view popup menu
                          [:r :!T9 :dbeaver ] ;; dbeaver: change active connection
                          [:w [:alfred "work_wiki_search"  "dhth.workwiki.search"]]
                          [:r [:alfred "reddit_search"  "dhth.reddit"]]
                          [:d [:alfred "karabiner_edn"  "dhth.tools"]]
                          [:h :hyphen]
                          [:u :!Shyphen]
                          [:l [:open "/Applications/Altair GraphQL Client.app"]] ;; open: Altair
                          [:i [:open "/Applications/IntelliJ IDEA.app"]] ;; open: Intellij
                          [:m [:open "/System/Applications/Messages.app"]] ;; open: Messages
                          ]
                  }

                 {:des   "f mode"
                  :rules [:f-mode
                          ; [:h :!SCopen_bracket :termemul] ;; for iterm
                          ; [:l :!SCclose_bracket :termemul] ;; for iterm
                          [:h [:!Ta :!S9] :termemul] ;; tmux: previous session
                          [:l [:!Ta :!S0] :termemul] ;; tmux: next session
                          [:s [:!Ta :!Tm] :termemul] ;; tmux: session menu
                          [:s [:!Ff] :browser] ;; browser: full screen toggle (vimium interferes with this, use in a new tab)
                          [:g [:!SCf :!Cg] :code]  ;; vscode: foam: show graph
                          [:a :!SCa :jetbrains] ;; find action
                          [:j [:spacebar :j :f ] :termemul ] ;; nvim/ftplugin/markdown.vim > wiki#Helpers()
                          [:k [:!Ta :z] :termemul ] ;; tmux: prefix z
                          ]}

                 {:des   "g mode"
                  :rules [:g-mode
                          [:i [:alfred "github_issues" "dhth.bookmarks"]] ;; bookmarks: github issues
                          [:k [:!Ssemicolon :!S1 :g :o :k :u]]
                          [:d [:spacebar :g :d] :termemul] ;; vim: telescope: search changed files (git diff)
                          [:h [:alfred "github_repo_search"  "dhth.github"]]
                          [:quote [:g :r :i :!Squote]]
                          [:8 [:alfred "github_stars_search"  "dhth.github"]] ;; github: stars
                          [:9 [:g :r :i :!S9]]
                          [:open_bracket [:g :r :i :open_bracket]]
                          [:s [:spacebar :g :s ] :termemul ]
                          [:p [:spacebar :g :p] :termemul ] ;; vim: fugitive: git push
                          [:b [:spacebar :g :b] :termemul ] ;; vim: telescope: git branches
                          [:quote [:g :r :i :quote] :termemul ] ;; vim: replace with regiser: gri"
                          ]}

                 ; {:des   "l mode"
                 ;  :rules [:l-mode
                 ;          [:t [:!CSt] :browser] ;; browser: re-open last tab
                 ;          ]}

                 {:des "js-mode"
                  :rules [:js-mode
                          [:a [:c :o :n :s :o :l :e :period :l :o :g :!S9 :!S0 :left_arrow]] ; -> console.log()
                          ]}

                 {:des "left-shift mode"
                  :rules [:left-shift-mode
                         ; [:right_shift [:open-a "Intellij Idea"]]
                         ; [:right_shift :!SOs :termemul]  ;; vim: quick language snippet 1
                         [:delete_or_backspace [:alfred "search_browser_tabs"  "com.epilande.browser-tabs"]]
                         [:right_shift [:!Ta :!Tw] :termemul]  ;; tmux: go to last window
                         [:spacebar [:!Ta :!Tg] :termemul] ;; tmux: session menu
                         [:up_arrow :!Tk ] ;; ctrl+k
                         [:down_arrow :!Tj ] ;; ctrl+j
                         [:left_arrow :!Th ] ;; ctrl+h
                         [:right_arrow :!Tl ] ;; ctrl+l
                         ; [:delete_or_backspace [:open-a "Preview"]]
                         ; [:return_or_enter [:open-a "Preview"]]
                          ]}

                 {:des "right-shift mode"
                  :rules [:right-shift-mode
                         [:left_shift :!SOa :termemul]  ;; vim: quick language snippet 2
                         [:t [:alfred "timezone"  "carlosnz.timezones2"]]
                         [:q [:open "/System/Applications/Messages.app"]] ;; open: Messages
                         [:a [:open "/System/Applications/Preview.app"]] ;; open: Preview
                         [:s [:open "/Applications/IntelliJ IDEA.app"]] ;; open: Intellij
                         [:z [:open "/Applications/zoom.us.app"]] ;; open: Zoom
                         [:o [:open "/Applications/Obsidian.app"]] ;; open: Obsidian
                         [:1 [:!Ta :!S1] :termemul] ;; tmux: layout 1
                         [:2 [:!Ta :!S2] :termemul] ;; tmux: layout 2
                         [:3 [:!Ta :!S3] :termemul] ;; tmux: layout 3
                         [:4 [:!Ta :!S4] :termemul] ;; tmux: layout 4
                         [:5 [:!Ta :!S5] :termemul] ;; tmux: layout 5
                         [:s [:!Ta :!Tv]] ;; tmux: persistent popup full screen
                          ]}

                 {:des   "m mode"
                  :rules [:m-mode
                          ; [:1 :!TOS1] ;; amethyst: throw focussed window to space 1
                          ; [:2 :!TOS2] ;; amethyst: throw focussed window to space 2
                          ; [:3 :!TOS3] ;; amethyst: throw focussed window to space 3
                          ; [:4 :!TOS4] ;; amethyst: throw focussed window to space 4
                          ; [:5 :!TOS5] ;; amethyst: throw focussed window to space 5
                          ; [:6 :!TOS6] ;; amethyst: throw focussed window to space 6
                          ; [:1 ["/opt/homebrew/bin/yabai -m window --space 1 --focus"]] ;; yabai: move window to space 1
                          ; [:2 ["/opt/homebrew/bin/yabai -m window --space 2 --focus"]] ;; yabai: move window to space 2
                          ; [:3 ["/opt/homebrew/bin/yabai -m window --space 3 --focus"]] ;; yabai: move window to space 3
                          ; [:4 ["/opt/homebrew/bin/yabai -m window --space 4 --focus"]] ;; yabai: move window to space 4
                          ; [:5 ["/opt/homebrew/bin/yabai -m window --space 5 --focus"]] ;; yabai: move window to space 5
                          ; [:6 ["/opt/homebrew/bin/yabai -m window --space 6 --focus"]] ;; yabai: move window to space 6
                          [:f :!OSk ] ;; amethyst: move focus clockwise
                          ; [:1 [:alfred "search_tracks"  "dhth.spotify"]]
                          ; [:2 [:alfred "search_albums"  "dhth.spotify"]]
                          ; [:3 [:alfred "search_artists"  "dhth.spotify"]]
                          ; [:4 [:alfred "search_related_artists"  "dhth.spotify"]]
                          ; [:5 [:alfred "search_playlists"  "dhth.spotify"]]
                          [:s [:alfred "search"  "dhth.spotify"]]
                          [:j :!TOCj ] ;; dato join meeting
                          [:l [:alfred "means_like"  "dhth.vocabulary"]]
                          [:p [:alfred "karabiner_mappings"  "dhth.karabiner"]] ;; alfred: show karabiner mappings
                          [:i [:open "http://127.0.0.1:8003/on-my-mind/on-my-mind/"]] ;; brain: open on my mind webpage
                          [:k [:open "/Applications/Keyboard Maestro.app"]]
                          [:c [:spacebar :m :c] :termemul] ;; vim: close tab
                          [:e :!SCm :slack] ;; slack: mentions
                          ; [:1 [:km "window: fs: move to display 1"]] ;; km: move to display 1
                          ; [:2 [:km "window: fs: move to display 2"]] ;; km: move to display 2
                          ; [:3 [:km "window: fs: move to display 3"]] ;; km: move to display 3
                          [:1 :!COTS1] ;; hammerspoon: move full screen to screen 1
                          [:2 :!COTS2] ;; hammerspoon: move full screen to screen 2
                          [:3 :!COTS3] ;; hammerspoon: move full screen to screen 3
                          ]}

                 {:des   "n mode"
                  :rules [:n-mode
                          [:a [:alfred "notion_omm_add"  "dhth.notion"]]
                          [:l [:alfred "notion_omm_list"  "dhth.notion"]]
                          ; [:s [:open "https://notion.so"]]
                          [:s [:!Ta :!Sp] :termemul] ;; tmux:: new session with general py
                          ; [:s [:alfred "search" "com.wrjlewis.notion-search"]] ;; alfred: notion search
                          [:p [:alfred "get_current_track"  "dhth.spotify"]] ;; now playing
                          [:t [:spacebar :n :t] :termemul] ;; vim: go to next test
                          [:1 [:spacebar :t :1] :termemul] ;; vim: tab 1
                          [:2 [:spacebar :t :2] :termemul] ;; vim: tab 2
                          [:3 [:spacebar :t :3] :termemul] ;; vim: tab 3
                          [:4 [:spacebar :t :4] :termemul] ;; vim: tab 4
                          [:5 [:spacebar :t :5] :termemul] ;; vim: tab 5
                          [:6 [:spacebar :t :6] :termemul] ;; vim: tab 6
                          [:7 [:spacebar :t :7] :termemul] ;; vim: tab 7
                          [:8 [:spacebar :t :8] :termemul] ;; vim: tab 8
                          [:9 [:spacebar :t :9] :termemul] ;; vim: tab 9
                          [:0 [:spacebar :t :0] :termemul] ;; vim: tab last
                          [:f [:spacebar :n :f] :termemul] ;; vim: new file at location
                          ]}

                 {:des   "q mode"
                  :rules [:q-mode
                          [:a [:alfred "quick_task_add"  "dhth.tasks.quick"]]
                          ; [:l [:alfred "quick_tasks_list"  "dhth.tasks.quick"]]
                          [:s :!CS4] ;; quick screenshot
                          [:u [:alfred "add_quick_url"  "dhth.bookmarks"]]
                          [:l [:alfred "quick_url_list"  "dhth.bookmarks"]]
                          ]}


                 {:des   "p mode"
                  :rules [:p-mode
                          [:1 [:alfred "pomodoro_work"  "dhth.pomodoro"]]
                          [:2 [:alfred "pomodoro_personal"  "dhth.pomodoro"]]
                          [:l [:alfred "search"  "dhth.pocket"]]
                          [:a [:alfred "add"  "dhth.pocket"]]
                          ; [:r [:!Ck :v] :code] ;; vscode: markdown: open md preview to the side
                          ; [:r [:alfred "pull_requests" "dhth.bookmarks"]] ;; bookmarks: pull requests
                          [:r [:alfred "open_prs" "dhth.bookmarks"]] ;; bookmarks: open pull requests
                          [:g [:spacebar :p :g] :termemul] ;; vim: edit plugins file
                          [:i [:!Ssemicolon :!Sp :l :u :g :!Si :n :s :t :a :l :l] :termemul] ;; vim: PlugInstall
                          [:u [:!Ssemicolon :!Sp :l :u :g :!Su :p :d :a :t :e] :termemul] ;; vim: PlugUpdate
                          ; [:s [:alfred "add_pushups" "dhth.pushups"]] ;; pushups: add pushups
                          [:s [:alfred "pomodoro_start" "dhth.pomodoro"]] ;; pomodoro: start pomodoro
                          [:b [:alfred "pomodoro_break_start" "dhth.pomodoro"]] ;; pomodoro: start break
                          [:o "/opt/homebrew/bin/tmux switch -t wiki:po && open -a \"Alacritty\"" ] ;; tmux: switch to punchout
                          ; [:o [:open "/Applications/Postman.app"]]
                          ]}

                 {:des   "r mode"
                  :rules [:r-mode
                          [:a [:alfred "add" "me.westerlind.alfred.raindrop-search"]]
                          [:s [:alfred "search" "me.westerlind.alfred.raindrop-search"]]
                          [:j [:!SCf :!Cj] :code] ;; vscode: foam: run janitor
                          [:e [:spacebar :r :e] :termemul] ;; vim: telescope: resume
                          [:m [:spacebar :r :m] :termemul] ;; vim: scala: runMain
                          [:t [:spacebar :r :t] :termemul] ;; vim: run tests
                          [:o [:alfred "right_option" "dhth.karabiner"]] ;; alfred: switch right opt
                          [:f [:spacebar :r :f] :termemul] ;; vim: telescope: search related files
                          [:f :!OCl :jetbrains] ;; jetbrains: reformat code
                          [:f :!TSf :dbeaver] ;; dbeaver: reformat code
                          [:f [:spacebar :r :f] :termemul] ;; vim: <leader>rf
                          [:u [:spacebar :r :u] :termemul] ;; vim: run line as command
                          [:w [:alfred "random_word" "dhth.vocabulary"]] ;; alfred: random word
                          [:v [:km "system: restart vim"] ] ;; karabiner: system: restart vim
                          ; [:spacebar [:alfred "replaceable_spacebar" "dhth.karabiner"]] ;; replaceable spacebar
                          ]}

                 {:des   "s mode"
                  :rules [:s-mode
                          ; [:t [:alfred "search_tools"  "dhth.tools"]]
                          [:t [:spacebar :s :t :c] :termemul] ;; vim: search tests for current file
                          [:t [:!SOCs] :dbeaver] ;; dbeaver: open settings
                          [:t [:!SCy] :slack] ;; slack: set status
                          [:t [:!SCf] :browser] ;; brower: show/hide toolbar
                          [:0 [:alfred "save_current_track"  "dhth.spotify"]]
                          [:6 [:spacebar :s :6] :termemul] ;; vim :treesitter: swap previous function
                          [:9 [:spacebar :s :9] :termemul] ;; vim :treesitter: swap next function
                          [:7 [:spacebar :s :7] :termemul] ;; vim :treesitter: swap previous parameter
                          [:8 [:spacebar :s :8] :termemul] ;; vim :treesitter: swap next parameter
                          [:o [:!Ssemicolon :s :o :spacebar :!S5] :termemul]
                          [:o :!SCi :jetbrains] ;; jetbrains: reload
                          [:a [:alfred "aws_account_switch" "dhth.aws"]] ;; alfred: aws: account switch
                          [:b [:alfred "search_brain"  "dhth.brain"]] ;; alfred: dhth.brain: search brain
                          [:d [:alfred "wiki_file"  "dhth.wiki.search"]]
                          [:c [:launch "Screenshot"]]
                          ; [:l :!Ts :termemul]
                          ; [:l :slash :termemul]
                          [:f :!Tf :termemul]
                          [:q [:y :s :i :w :!Squote] :termemul]
                          [:m [:spacebar :s :m] :termemul] ;; vim: telescope: coc: document_symbols
                          [:m :!Cf12 :jetbrains]  ;; jetbrains: file structure
                          [:n [:!Ta :!Sn] :termemul] ;; tmux: pane picker for current session
                          ; [:p [:open "/Applications/Spotify.app"]]
                          [:p [:spacebar :s :p] :termemul] ;; vim: search projects
                          [:y [:alfred "synonyms"  "dhth.vocabulary"]]
                          ; [:w [:!SOCs :w] :jetbrains] ;; datagrip: switch session
                          ; [:w :!TOSk] ;; amethyst: swap focussed window clockwise
                          [:w [:alfred "search_wikis" "dhth.bookmarks"]] ;; alfred: search wikis
                          ;; shift + option + arrow keys
                          ; [:h [:!Ta :h] :termemul] ;; tmux prefix + h
                          ; [:j [:!Ta :j] :termemul] ;; tmux prefix + j
                          ; [:k [:!Ta :k] :termemul] ;; tmux prefix + k
                          ; [:l [:!Ta :l] :termemul] ;; tmux prefix + l
                          [:u :!TCu :browser] ;; browser: notion web clipper
                          ; [:##h :!SOleft_arrow]
                          ; [:##j :!SOdown_arrow]
                          ; [:##k :!SOup_arrow]
                          ; [:##l :!SOright_arrow]
                          [:l [:!Ta :!Sbackslash] :termemul]
                          [:j [:!Ta :hyphen] :termemul]
                          ]}

                 {:des   "t mode"
                  :rules [:t-mode
                          [:a [:alfred "tasks_personal_add"  "dhth.tasks"]]
                          ; [:b [:alfred "todays_brain_webpage"  "dhth.brain"]] ;; alfred: dhth.brain : todays brain webpage
                          [:e [:spacebar :t :e] :termemul] ;; vim: markdown: add task entry
                          ; [:l [:alfred "tasks_personal_list"  "dhth.tasks"]]
                          [:l [:alfred "go_to_todays_log"  "dhth.logs"]] ;; vim: logs: go to today's log
                          [:0 [:alfred "get_current_track"  "dhth.spotify"]]
                          [:h :!SCt :slack] ;; slack: threads
                          [:i "/opt/homebrew/bin/tmux switch -t wiki:h && open -a \"Alacritty\"" ] ;; tmux: switch to hours
                          [:m [:alfred "time"  "dhth.system"]]
                          [:n [:!Ta :!Tp] :termemul] ;; tmux: txw
                          ; [:w [:alfred "tmux_windows"  "dhth.tmux"]] ;; tmux: switch between all windows on a server
                          ; [:s [:alfred "tmux_sessions"  "dhth.tmux"]] ;; tmux: switch between sessions
                          [:s :!OSa :browser] ;; browser: dark mode: toggle current site
                          ; [:s "/opt/homebrew/bin/tmux send-keys -t wiki:w \":e ~/.tsw\" ENTER && /opt/homebrew/bin/tmux switch -t wiki:wiki" :termemul ] ;; tmux: open tsw
                          [:b :!SCf :browser] ;; browser: toolbar visibility
                          [:s "~/.cargo/bin/tomo start && /opt/homebrew/bin/tmux display -d 1000 \"start\"" :termemul] ;; tomo: start
                          [:b "~/.cargo/bin/tomo break && /opt/homebrew/bin/tmux display -d 1000 \"break\"" :termemul] ;; tomo: break
                          [:r [:spacebar :t :r] :termemul] ;; vim: test results
                          [:d [:spacebar :t :d] :termemul] ;; vim: todo telescope
                          [:y [:open "https://monkeytype.com"]]
                          [:o :!OC3 :pdfviewer ] ;; pdfviewer: table of contents
                          ]}

                 {:des "u mode"
                  :rules [:u-mode
                          [:r :!SCa :slack] ;; slack: unread messages
                          ]}

                 {:des   "v mode"
                  :rules [:v-mode
                          [:p [:alfred "vim_plugins"  "dhth.vim"]]
                          ; [:h [:!Ta :h] :termemul] ;; tmux prefix + h
                          ; [:l [:!Ta :l] :termemul] ;; tmux prefix + l
                          ; [:j [:!Ta :j] :termemul] ;; tmux prefix + j
                          ; [:k [:!Ta :k] :termemul] ;; tmux prefix + k
                          [:l [:spacebar :s :l] :termemul] ;; vim: wiki_helpers: open current page's webview
                          [:n [:spacebar :v :n] :termemul] ;; vim: vnew
                          [:m :!TSOCv ] ;; vimac: activate hint mode
                          [:s :!TSCs ] ;; vimac: activate scroll mode
                          ; [:s [:spacebar :v :s] :termemul] ;; vim: vsplit
                          [:k [:!Ck :!Cs] :code] ;; vscode: keyboard shortcuts
                          ; [:c [:alfred "vocabulary"  "dhth.vocabulary"]]
                          [:c [:spacebar :v :c] :termemul] ;; vim: gitsigns: preview hunk
                          [:r [:alfred "vocab_records"  "dhth.vocabulary"]]
                          [:n :!OSCs :arc] ;; arc: create a vertical split
                          ]}

                 {:des   "w mode"
                  :rules [:w-mode
                          [:e [:alfred "wiki_search"  "dhth.wiki.search"]]
                          ; [:c [:alfred "webcam"  "dhth.system"]]
                          ; [:h :!SOCh] ;; magnet previous display
                          ; [:l :!SOCl] ;; magnet next display
                          [:open_bracket :!TOh] ;; magnet left side
                          [:close_bracket :!TOl] ;; magnet left side
                          [:h [:!Ta :h] :termemul] ;; tmux prefix + h
                          [:j [:!Ta :j] :termemul] ;; tmux prefix + j
                          [:k [:!Ta :k] :termemul] ;; tmux prefix + k
                          [:l [:!Ta :l] :termemul] ;; tmux prefix + l
                          [:h :!OSCh :arc] ;; arc: switch to left pane
                          [:l :!OSCl :arc] ;; arc: switch to right pane
                          [:q [:!Ssemicolon :w :q] :termemul]
                          [:o [:alfred "workout_log_url"  "dhth.bookmarks"]]
                          ]}

                 {:des "x-mode"
                  :rules [:x-mode
                          [:j [:!Ta :hyphen] :termemul] ;; termemul: tmux: prefix + -
                          [:l [:!Ta :!Sbackslash] :termemul] ;; termemul: tmux: prefix + |
                          [:c [:!SOc] :browser] ;; brower: excalidraw: export to png
                          ]}

                 {:des "emoji-mode"
                  :rules [:z-mode
                          [:e :emoji_picker]
                          [:t [:km "emoji: thunder"] ]
                          ; [:c [:km "emoji: check mark"] ]
                          [:c "/opt/homebrew/bin/hs -c \"hs.eventtap.keyStrokes('✅')\"" ] ;; hammerspoon: type out check mark
                          [:i "/opt/homebrew/bin/hs -c \"hs.eventtap.keyStrokes('⏳')\"" ] ;; hammerspoon: type out check mark
                          [:0 [:km "emoji: smile"] ]
                          ; [:j [:km "emoji: point down"] ]
                          ; [:k [:km "emoji: point up"] ]
                          [:k "/opt/homebrew/bin/hs -c \"hs.eventtap.keyStrokes('👆')\"" ] ;; hammerspoon: type out up arrow
                          [:j "/opt/homebrew/bin/hs -c \"hs.eventtap.keyStrokes('👇')\"" ] ;; hammerspoon: type out down arrow
                          [:x "/opt/homebrew/bin/hs -c \"hs.eventtap.keyStrokes('👍')\"" ] ;; hammerspoon: type out thumbs up
                          [:a [:!SOCm]] ;; zoom: toggle audio
                          [:d [:!SOCd] :zoom] ;; zoom: toggle dual monitor
                          [:s [:alfred "zshrc"  "dhth.tools"]]
                          ; [:p [:km "psss"] ]
                          ;
                          ]}

                 {:des   "other stuff"
                  :rules [:equal-mode
                          [:1 [:application "Brave Browser" "set the clipboard to title of active tab of first window as text"]]
                          [:2 [:application "Brave Browser" "set the clipboard to title of active tab of second window as text"]]
                          ; [:w [:km "setup: office"]]
                          [:w [:km "setup: office"]]
                          [:a [:slash :a :w :a :y] :slack] ;; slack: type /away
                          [:f [:open "https://fast.com"]] ;; browser: open fast.com
                          ]}

                 {:des   "comma mode"
                  :rules [:comma-mode
                          [:s [:alfred "slack_status" "dhth.slack.status"]] ;; slack: change slack status
                          [:v [:alfred "vim_plugins" "dhth.vim"]]
                          ; [:c [:alfred "control" "dhth.spotify"]]
                          [:c [:!COTc]] ;; hammerspoon: toggle console
                          ; [:2 [:alfred "albums" "dhth.spotify"]]
                          ; [:5 [:alfred "playlists" "dhth.spotify"]]
                          ; [:6 [:alfred "recently_played" "dhth.spotify"]]
                          [:d [:alfred "devices" "dhth.spotify"]]
                          [:a [:alfred "add_track_to_playlist" "dhth.spotify"]] ;; spotify: add track to playlist
                          [:r :!TOCr] ;; hammerspoon: reload config
                          [:1 [["lc-browser" 1] ["lc-preview" 0] ["lc-intellij-idea" 0] ["lc-zoom" 0]]]
                          [:2 [["lc-browser" 0] ["lc-preview" 1] ["lc-intellij-idea" 0] ["lc-zoom" 0]]]
                          [:3 [["lc-browser" 0] ["lc-preview" 0] ["lc-intellij-idea" 1] ["lc-zoom" 0]]]
                          [:4 [["lc-browser" 0] ["lc-preview" 0] ["lc-intellij-idea" 0] ["lc-zoom" 1]]]
                          ; [:1 :!TOC1] ;; amethyst: full screen mode
                          ; [:2 :!TOC2] ;; amethyst: 2 pane layout
                          ; [:3 :!TOC3] ;; amethyst: floating layout
                          ; [:1 :!TOC1] ;; hammerspoon: move to screen 1
                          ; [:2 :!TOC2] ;; hammerspoon: move to screen 2
                          ; [:3 :!TOC3] ;; hammerspoon: move to screen 3
                          ]}

                 {:des "slash mode"
                  :rules [:slash-mode
                          [:f [:g :c :a :f] :termemul] ;; vim: comment function
                          [:c [:g :c :a :f] :termemul] ;; vim: comment class
                          ]}

                 {:des "spacebar"
                  :rules [:spacebar-mode
                          [:##h :!TOCleft_arrow]
                          [:##l :!TOCright_arrow]
                          [:##j :!TOCdown_arrow]
                          [:##k :!TOCup_arrow]
                          [:g [:spacebar :g :s] :termemul]
                          [:q :!OSCq :arc] ;; arc: close tab
                          ; [:left_shift [:alfred "search" "dhth.bookmarks"]]
                          [:left_shift [:spacebar :equal_sign :spacebar]]
                          ; [:1 [:open "/Applications/IntelliJ IDEA.app"]] ;; custom-app-1
                          ; [:2 [:open "/Applications/Postman.app"]] ;; custom-app-2
                          ; [:3 [:open "/Applications/zoom.us.app"]] ;; custom-app-3
                          ; [:4 [:open "/Applications/DBeaver.app"]] ;; custom-app-4
                          ; [:5 [:open "/System/Applications/Preview.app"]] ;; custom-app-5
                          ]}

                 {:des   "caps_lock mode"
                  :rules [:caps-lock-mode
                          [:##h :left_arrow]
                          [:##l :right_arrow]
                          [:##j :down_arrow]
                          [:##k :up_arrow]
                          [:semicolon [:spacebar :g :d] :termemul] ;; vim: telescope: search changed files
                          ]}

                 {:des   "tilde mode"
                  :rules [:tilde-mode
                          [:b [:alfred "save_tab" "dhth.bookmarks"]] ;; alfred: save browser tab to buku
                          ; [:q [:km "quicktime: movie"]]
                          [:q [:!COTq]] ;; hammerspoon: quicktime: movie
                          ; [:h [:km "mouse: move_left"]]
                          ; [:l [:km "mouse: move_right"]]
                          [:h [:!COTSh]] ;; hammerspoon: move mouse left
                          [:l [:!COTSl]] ;; hammerspoon: move mouse right
                          [:j [:!COTSj]] ;; hammerspoon: move mouse down
                          [:k [:!COTSk]] ;; hammerspoon: move mouse up
                          [:hyphen [:alfred "pause" "dhth.spotify"]]
                          [:equal_sign [:alfred "play" "dhth.spotify"]]
                          [:1 [:type-secret "praline-jingle"]]
                          [:2 [:type-secret "haven-barnyard"]]
                          [:m [:alfred "work_email" "dhth.bookmarks"]] ;; alfred: open work email
                          [:c [:alfred "work_calendar" "dhth.bookmarks"]] ;; alfred: open work calendar
                          [:semicolon [:alfred "work_main_url" "dhth.bookmarks"]] ;; alfred: bookmarks: work main url
                          [:spacebar :!OSspacebar ] ;; amethyst: cycle layout
                          ]}

                 {:des   "quote mode"
                  :rules [:quote-mode 
                          ; this is mostly for duckyo3m
                          [:b [:alfred "save_tab" "dhth.bookmarks"]] ;; alfred: save browser tab to buku
                          [:q [:km "quicktime: movie"]]
                          [:h [:km "mouse: move_left"]]
                          [:l [:km "mouse: move_right"]]
                          [:hyphen [:alfred "pause" "dhth.spotify"]]
                          [:equal_sign [:alfred "play" "dhth.spotify"]]
                          [:1 [:type-secret "praline-jingle"]]
                          [:2 [:type-secret "haven-barnyard"]]
                          [:m [:alfred "work_email" "dhth.bookmarks"]] ;; alfred: open work email
                          [:c [:alfred "work_calendar" "dhth.bookmarks"]] ;; alfred: open work calendar
                          [:semicolon [:alfred "work_main_url" "dhth.bookmarks"]] ;; alfred: bookmarks: work main url
                          ]}

                 {:des   "tab mode"
                  :rules [:tab-mode
                          [:##h :!SOleft_arrow ]
                          [:##j :!SOdown_arrow ]
                          [:##k :!SOup_arrow ]
                          [:##l :!SOright_arrow ]
                          [:s :!TSOCs] ;; mac: siri
                          [:d [:alfred "dark_mode" "dhth.system"]]
                          [:a [:alfred "switch_audio" "dhth.system"]]
                          [:b [:alfred "connect_to_bluetooth_device" "dhth.system"]]
                          [:z [:alfred "system_sleep" "dhth.system"]] ;; 1password: quick access
                          [:spacebar :!TSOCo]
                          [:i :!TOC8]
                          [:c :!OCf5]
                          ]}

                 {:des   "open bracket mode"
                  :rules [:open-bracket-mode
                          [:d [:spacebar :s :y] :termemul] ;; vim: SearchDockerComposeFiles
                          [:t [:spacebar :t :f] :termemul] ;; vim: Search test files
                          [:f [:spacebar :d :k :f] :termemul] ;; vim: SearchDockerFiles
                          [:l [:spacebar :l :o] :termemul] ;; vim: search local only files
                          [:g [:spacebar :g :h] :termemul] ;; vim: git helpers
                          [:close_bracket [:alfred "quick_open_url" "dhth.bookmarks"]]
                          ]}

                 {:des   "close bracket mode"
                  :rules [:close-bracket-mode
                          [:open_bracket [:alfred "quick_open_url_2" "dhth.bookmarks"]]
                          ]}

                 {:des   "other stuff"
                  :rules [:hyphen-mode
                          ; [:p [:application "spotify" "playpause"]]
                          ; [:open_bracket [:application "spotify" "previous track"]]
                          ; [:close_bracket [:application "spotify" "next track"]]
                          ; [:1 [:application "Brave Browser" "set the clipboard to URL of active tab of first window as text"]]
                          ; [:2 [:application "Brave Browser" "set the clipboard to URL of active tab of second window as text"]]
                          [:2 :!COSTq] ;; hammerspoon:: 50-50 window layout
                          [:3 :!COSTw] ;; hammerspoon:: 30-70 window layout
                          [:r :!TOCr] ;; hammerspoon:: reload config
                          [:s [:alfred "search_drive_file" "dhth.files"]]
                          ]}

{:des   "semicolon mode"
 :rules [:semicolon-mode
         [:a :!SCm :slack] ;; slack: activity view
         ; [:a [:!Ta :1] :termemul] ;; tmux prefix + 1
         ; [:s [:!Ta :2] :termemul]
         ; [:d [:!Ta :3] :termemul]
         ; [:f [:!Ta :4] :termemul]
         ; [:g [:!Ta :5] :termemul]
         ; [:h [:!Ta :6] :termemul]
         [:r :!T4 :slack] ;; slack: open later view
         [:t :!CSt :slack] ;; slack: open threads
         [:q [:!Ta :!Sq] :termemul] ;; tsw: show sessions
         [:tab "/opt/homebrew/bin/tmux send-keys -t wiki:w \":edit ~/.tsw\" ENTER && /opt/homebrew/bin/tmux switch -t wiki:w" :termemul] ;; tsw: edit tsw
         [:a "~/projects/dotfiles/utils/exe/tsw 1" :termemul] ;; tsw: go to session 1
         [:s "~/projects/dotfiles/utils/exe/tsw 2" :termemul] ;; tsw: go to session 2
         [:d "~/projects/dotfiles/utils/exe/tsw 3" :termemul] ;; tsw: go to session 3
         [:f "~/projects/dotfiles/utils/exe/tsw 4" :termemul] ;; tsw: go to session 4
         [:g "~/projects/dotfiles/utils/exe/tsw 5" :termemul] ;; tsw: go to session 5
         ; [:1 [:alfred "browser_modheader_switch_profile_1" "dhth.workutils"] :browser] ;; browser: modheader: profile 1
         ; [:2 [:alfred "browser_modheader_switch_profile_2" "dhth.workutils"] :browser] ;; browser: modheader: profile 2
         ; [:3 [:alfred "browser_modheader_switch_profile_3" "dhth.workutils"] :browser] ;; browser: modheader: profile 3
         ; [:4 [:alfred "browser_modheader_switch_profile_4" "dhth.workutils"] :browser] ;; browser: modheader: profile 4
         ; [:1 :!OSw] ;; amethyst: focus screen 1
         ; [:2 :!OSe] ;; amethyst: focus screen 2
         ; [:3 :!OSr] ;; amethyst: focus screen 3
         ; [:4 :!OSq] ;; amethyst: focus screen 4
         ; [:1 ["/opt/homebrew/bin/yabai -m display --focus 1"]] ;; yabai focus screen 1
         ; [:2 ["/opt/homebrew/bin/yabai -m display --focus 2"]] ;; yabai focus screen 2
         ; [:3 ["/opt/homebrew/bin/yabai -m display --focus 3"]] ;; yabai focus screen 3
         ; [:3 :!OSr] ;; amethyst: focus screen 3
         ; [:4 :!OSq] ;; amethyst: focus screen 4
         [:t [:!OSt] :browser] ;; browser: modheader: pause/resume
         ; [:c [:!Ta :c]] ;; tmux prefix + c
         [:r [:alfred "repo_search"  "dhth.workutils"]] ;; work utils: repo search
         [:c [:alfred "work_company_search"  "dhth.workutils"]] ;; work utils: work company search
         ; [:f [:alfred "fe_feature_search"  "dhth.workutils"]] ;; work utils: front end feature search
         [:w [:alfred "work_bookmarks" "dhth.bookmarks"]] ;; alfred: search work bookmarks
         ; [:s [:alfred "save_url_to_wiki" "dhth.bookmarks"]] ;; alfred: save url to a wiki
         ; [:a [:alfred "aws_account_switch" "dhth.aws"]] ;; alfred: aws: account switch
         [:1 [["lo-browser" 1] ["lo-preview" 0]]]
         [:2 [["lo-browser" 0] ["lo-preview" 1]]]
         ]}

{:des "left_option mode non apple"
 :rules [:left-option-mode-non-apple
         ; [:##h :!Oleft_arrow :!apple ]
         ; [:##j :!Odown_arrow :!apple]
         ; [:##k :!Oup_arrow :!apple ]
         ; [:##l :!Oright_arrow :!apple]
         [:##h :!TOCleft_arrow :!apple ]
         [:##l :!TOCright_arrow :!apple ]
         [:##j :!TOCdown_arrow :!apple ]
         [:##k :!TOCup_arrow :!apple ]
         [:1 :!SOC1]
         [:2 :!SOC2]
         [:3 :!SOC3]
         [:4 :!SOC4]
         [:5 :!SOC5]
         ; [:return_or_enter [:open "/System/Applications/Preview.app"]]

         ; turn this off when switching back to mapping opt to browser
         ; [:return_or_enter [:open-a "Brave Browser"]]
         ]}

{:des "left_option mode apple"
 :rules [:left-option-mode-apple
         [:##h :!Oleft_arrow :apple]
         [:##j :!Odown_arrow :apple]
         [:##k :!Oup_arrow :apple]
         [:##l :!Oright_arrow :apple]
         ; [:##h :!TOCleft_arrow]
         ; [:##l :!TOCright_arrow]
         ; [:##j :!TOCdown_arrow]
         ; [:##k :!TOCup_arrow]
         ]}


{:des "right option mode non apple"
 :rules [:right-option-mode-non-apple
         [:c [:alfred "ro_flag"  "dhth.karabiner"]]
         ]}

{:des "right command mode apple"
 :rules [:right-command-mode-apple
         [:c [:alfred "ro_flag"  "dhth.karabiner"]]
         ]}

{:des "left_command mode non apple"
 :rules [:left-command-mode-non-apple
         [:h [:!Ta :p] :termemul]
         [:l [:!Ta :n] :termemul]
         [:escape :!Cgrave_accent_and_tilde [:browser :duckyo3m]] ;; browser:: command-tilde:: duckyo3m
         [:escape :grave_accent_and_tilde :termemul] ;; termemul: command-esc to tilde:: duckyo3m
         ]}

{:des "caps lock to left control" :rules [
                                          [:##caps_lock :##left_control nil {:alone :escape}]
                                          ]
 }

{:des "left control to caps lock"
 :rules [
         ; [:##left_control :caps_lock]
         ; [:left_control [:alfred "search"  "dhth.bookmarks"]]
         [:##left_control :##left_control [:apple ["lc-browser" 1]] {:alone [:open "/Applications/Brave Browser.app"]}]
         [:##left_control :##left_control [:!apple ["lc-browser" 1]] {:alone [:open "/Applications/Brave Browser.app"]}]
         [:##left_control :##left_control [:apple ["lc-preview" 1]] {:alone [:open "/System/Applications/Preview.app"]}]
         [:##left_control :##left_control [:!apple ["lc-preview" 1]] {:alone [:open "/System/Applications/Preview.app"]}]
         [:##left_control :##left_control [:apple ["lc-intellij-idea" 1]] {:alone [:open "/Applications/IntelliJ IDEA.app"]}]
         [:##left_control :##left_control [:!apple ["lc-intellij-idea" 1]] {:alone [:open "/Applications/IntelliJ IDEA.app"]}]
         [:##left_control :##left_control [:apple ["lc-zoom" 1]] {:alone [:open "/Applications/zoom.us.app"]}]
         [:##left_control :##left_control [:!apple ["lc-zoom" 1]] {:alone [:open "/Applications/zoom.us.app"]}]
         [:##left_control :##left_control :apple {:alone [:open "/Applications/Brave Browser.app"]}] ;; left-control:: fallback
         [:##left_control :##left_control :!apple {:alone [:open "/Applications/Brave Browser.app"]}] ;; left-control:: fallback
         ]
 }

{:des "code"
 :rules [:code
         ; [:##left_shift :!Cp]
         [:##left_shift :##left_shift nil {
                                           :alone :!Cp}]         ;; vscode: file search
         ]}

{:des "jetbrains"
 :rules [:jetbrains
         [:##left_shift :##left_shift nil {
                                           :alone :!CSo}]         ;; jetbrains: file search
         ; [:##right_option :##right_option :!apple {
         ;                                   :alone :!Ce}]         ;; jetbrains: recent files
         ]}

{:des "not terminal"
 :rules [:!termemul
         ; [:##left_command :##left_command :apple {:alone [:open-a "Alacritty"]}]
         ; [:##left_option :##left_command :!apple {:alone [:open-a "Alacritty"]}]
         [:##left_command :##left_command :apple {:alone [:open "/Applications/Alacritty.app"]}]
         [:##left_option :##left_command :!apple {:alone [:open "/Applications/Alacritty.app"]}]
         ; [:##left_option :##left_command nil {:alone [:open "/Applications/iTerm.app"]}]
         ]}

{:des "neovide"
 :rules [:neovide
         [:##left_shift :##left_shift nil { :alone [:!Tf]}]         ;; fzf :Buffers
         ]}

{:des "terminal"
 :rules [:termemul
         [:##left_command :##left_command :apple {:alone [:!Ts] }]
         [:##left_option :##left_command :!apple {:alone [:!Ts]}]
         ; [:##left_option :##left_command nil {:alone [:!Ts]}]
         [:##left_shift :##left_shift nil { :alone [:!Tf]}]         ;; fzf :Buffers
         [:##right_shift :##right_shift nil {:alone [:!Ta :!Ts]}] ;; termemul: tmux: switch to last session
         [:##right_command :##right_command :apple {:alone [:!Ta :semicolon]}] ;; tmux prefix + ;
         [:##right_option :##right_option :!apple {:alone [:!Ta :semicolon]}] ;; tmux prefix + ;
         ; [:##right_shift :##right_shift nil {
         ;                                   :alone [:spacebar :w :n]}]         ;; fzf :Buffers
         ; [:##right_command :##right_command :apple {:alone [:spacebar :w :n]}] ;; fzf :Windows
         ; [:##right_option :##right_option :!apple {:alone [:spacebar :w :n]}] ;; fzf :Windows
         ; [:##right_option :##right_option :!apple {:alone [:spacebar :w :n]}] ;; fzf :Windows
         ; [:##right_command :##right_command :apple {:alone [:spacebar :w :n]}] ;; fzf :Windows
         ]}

{:des "left-option"
 :rules [
         [:##left_option :left_command [:apple ["lo-browser" 1]] {:alone [:open "/Applications/Brave Browser.app"]}]
         [:##left_command :left_option [:!apple ["lo-browser" 1]] {:alone [:open "/Applications/Brave Browser.app"]}]
         [:##left_option :left_command [:apple ["lo-preview" 1]] {:alone [:open "/System/Applications/Preview.app"]}]
         [:##left_command :left_option [:!apple ["lo-preview" 1]] {:alone [:open "/System/Applications/Preview.app"]}]
         [:##left_option :left_command :apple {:alone [:open "/Applications/Brave Browser.app"]}] ;; left-option: fallback
         [:##left_command :left_option :!apple {:alone [:open "/Applications/Brave Browser.app"]}] ;; left-option: fallback
         ]
 }

{:des "browser"
 :rules [:browser
         [:##left_shift :##left_shift nil { :alone :!St}]         ;; browser: vimium: search open tabs
         [:##right_shift :##right_shift nil { :alone :!S6}]         ;; browser: vimium: switch to last tab
         ; [:##left_option :##left_option :apple {:alone [:s :t]}] ;; vimium show open tabs
         ; [:##left_command :##left_option :!apple {:alone [:s :t]}] ;; vimium show open tabs
         ; [:##left_command :##left_option nil {:alone [:!St]}] ;; vimium show open tabs
         ; [:##right_option :##right_option :!apple {:alone :!Ct}] ;; new tab
         ]
 }

{:des "jetbrains"
 :rules [:jetbrains
         [:##right_shift :##right_shift nil { :alone :!TSCm}]  ;; jetbrains: open context menu
         ]
 }

{:des "right-option"
 :rules [
         [:##right_control :right_control :!apple {:alone [:open-a "Slack"]}] ;; replaceable-right-control-app-non-apple
         [:##right_option :right_option :apple {:alone [:open-a "Slack"]}] ;; replaceable-right-option-app-apple
         ]
 }

{:des "slack"
 :rules [:slack
         [:##left_shift :##left_shift nil { :alone [:km "slack: messages sent to me"]}] ;; slack: message sent to me
         [:##right_shift :##right_shift nil { :alone [:km "slack: messages sent by me"]}] ;; slack: message sent by me
         ]
 }


{:des "pdf viewer"
 :rules [:pdfviewer
         [:h :left_arrow ]
         [:j :down_arrow ]
         [:k :up_arrow ]
         [:l :right_arrow ]
         [:hyphen :!Chyphen ]
         [:equal_sign :!Cequal_sign ]
         [:##left_shift :##left_shift nil {
                                           :alone [:!OC1]}]         ;; pdfviewer: show side bar
         ]
 }

{:des "vscode"
 :rules [:code
         ; [:##right_shift :##right_shift nil {:alone [:!SCp]}] ;; vscode command palette
         [:##right_option :##right_option nil {:alone [:!SCp]}] ;; vscode command palette
         [:##right_command :##right_command :apple {:alone [:!SCp]}] ;; vscode command palette
         ]
 }

{:des "shifts"
 :rules [
         [:##left_shift :left_shift nil {:alone :!Oleft_arrow}]
         ]
 }

]
}
;; rule [:period ["media-mode" 1] nil {:afterup ["media-mode" 0] :alone :period}]
;;       |_____| |_______________| |_| |_________________________________________|
;;        <from>    <to>      <conditions>         <other options>

;; !  | means mandatory
;; #  | means optional
;; C  | left_command
;; T  | left_control
;; O  | left_option
;; S  | left_shift
;; F  | fn
;; Q  | right_command
;; W  | right_control
;; E  | right_option
;; R  | right_shift
;;
;; !! | mandatory command + control + optional + shift (hyper)
;; ## | optional any
;;
